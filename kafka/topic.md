# 토픽

## 정의 및 특징

- 카프카에서는 토픽을 여러 개 생성할 수 있음
- DB 테이블 혹은 파일시스템의 디렉토리와 유사
- 프로듀서는 토픽에 데이터를 넣고, 컨슈머는 토픽에서 데이터를 빼냄
- 이름을 지정할 수 있어 명확한 이름을 사용하면 유지보수에 도움이 됨

## Details

### 파티션 1개

- 하나의 토픽은 여러 개의 파티션으로 구성될 수 있다.
- 파티션 번호는 0번부터 시작
- 데이터는 큐처럼 쌓임
- 컨슈머는 토픽에 쌓인 가장 오래된 데이터를 가져간다(FIFO)
- 컨슈머가 레코드를 가져가도 토픽의 데이터는 삭제되지 않고 파티션에 남아있다.
	- 새로운 컨슈머가 붙었을 때 이 남아있는 데이터를 가져가야 한다. 단, 조건이 있다.
		- 컨슈머 그룹이 다르고 `auto.offset.reset` 의 값이 `earliest` 여야 한다.
	- 이렇게 사용할 경우 동일 데이터를 두 번 이상 처리할 수 있다.

### 파티션 두 개 이상

- 키가 null 이고 기본 파티셔너를 사용
	- 라운드 로빈
- 키가 있고 기본 파티셔너를 사용
	- 키의 해시 값을 계산한 다음, 해시 값에 따라 특정 파티션에 할당
- 파티션은 확장만 되고 축소는 안된다.

### 레코드의 삭제

- 파티션의 레코드에는 최대 보존시간과 최대 보존 크기를 지정할 수 있다.
	- `log.retention.ms`
	- `log.retention.byte`
 

---
#kafka